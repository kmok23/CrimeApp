---
title: "sfcrime"
author: "Kent Mok"
date: "January 13, 2016"
output: html_document
---


```{r load_data}
trainraw <- read.csv("Data/train.csv")

# Load packages
Installed <- require("plyr")
if (!Installed) {
    install.packages("plyr")
    library("plyr")
}

Installed <- require("ggplot2")
if (!Installed) {
    install.packages("ggplot2")
    library("ggplot2")
}

Installed <- require("scales")
if (!Installed) {
    install.packages("scales")
    library("scales")
}
```

#Exploratory Data Analysis

```{r}
summary(trainraw)
str(trainraw)
unique(trainraw$Category)
```

#Clean Data
```{r}
# Convert Dates variable from factor to date
trainraw$Dates <- as.Date(trainraw$Dates)
# Count daily frequency of each crime
freqByCategory <- count(trainraw, c("Dates", "Category"))

# Create data frame with only data from Category of ARSON
dataByArson <- freqByCategory[freqByCategory$Category == "ARSON", c(1, 3)]
# Extract month and year into new variables
dataByArson$Month <- as.Date(cut(dataByArson$Dates, breaks = "month"))
dataByArson$Year <- as.Date(cut(dataByArson$Dates, breaks = "year"))

# Plot by month
plotByMonth <- ggplot(data = dataByArson, aes(Month, freq))
plotByMonth <- plotByMonth +
    stat_summary(fun.y = sum,  # adds up all observations for the month
    geom = "line")
plotByMonth <- plotByMonth +
    scale_x_date(labels = date_format("%m/%Y"))  # custom x-axis labels
plotByMonth <- plotByMonth + ggtitle("Arson by Month")
print(plotByMonth)

# Plot by year
plotByYear <- ggplot(data = dataByArson, aes(Year, freq))
plotByYear <- plotByYear +
    stat_summary(fun.y = sum,  # adds up all observations for the month
    geom = "line")
plotByYear <- plotByYear +
    scale_x_date(labels = date_format("%Y"))  # custom x-axis labels
plotByYear <- plotByYear + ggtitle("Arson by Year")
print(plotByYear)

```
